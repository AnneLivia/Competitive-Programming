This code is not ready yet, it needs some optimization
